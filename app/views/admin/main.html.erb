<section id="cover" class="admin-page min-vh-100">
  <div class="container min-vh-100">
    <div class="row" id="organisation">
      <h2>Organisation</h2>
      <div class="col">
        <div class="input-group mb-3">
          <span class="input-group-text" id="basic-addon1">Name</span>
          <input type="text" class="form-control" value="<%= @organisation.name %>" disabled />
          <i class="input-group-text name-marker fas fa-edit"></i>
        </div>
      </div>
      <div class="col">
        <div class="input-group mb-3">
          <span class="input-group-text" id="basic-addon1">Quiz Count</span>
          <input type="text" class="form-control" value="<%= @quizzes.length %>" disabled />
        </div>
      </div>
      <div class="col">
        <div class="input-group mb-3">
          <span class="input-group-text" id="basic-addon1">User Count</span>
          <input type="text" class="form-control" value="<%= @users.all.where(approved: true).length %>" disabled />
        </div>
      </div>
    </div>
    <div class="row" id="quizzes">
      <h2>Quizzes</h2>
      <div class="col">
        <table class="table table-light table-hover">
          <thead>
          <tr>
            <th scope="col">Name</th>
            <th scope="col">No. of Attempts</th>
          </tr>
          </thead>
          <tbody>
          <% @quizzes.each do |quiz| %>
            <tr>
              <td>
                <a href="/admin/quizzes/<%= quiz.id %>">
                  <%= quiz.name %>
                </a>
              </td>
              <td>
                <a href="/admin/quizzes/<%= quiz.id %>">
                  <%= QuizAttempt.all.where(quiz_id: quiz.id).count %>
                </a>
              </td>
            </tr>
          <% end %>
          </tbody>
        </table>
      </div>
    </div>
    <% if @users.all.where(approved: false).length > 0 %>
      <div class="row" id="requested-users">
        <h2>Requested Users</h2>
        <div class="col">
          <table class="table table-light table-hover">
            <thead>
            <tr>
              <th scope="col">
                <input class="form-check-input" type="checkbox" id="main-checkbox" checked>
              </th>
              <th scope="col" class="hidden"></th>
              <th scope="col">First Name</th>
              <th scope="col">Last Name</th>
              <th scope="col">Email</th>
            </tr>
            </thead>
            <tbody>
            <% @users.all.where(approved: false).each do |user| %>
              <tr>
                <td>
                  <input class="form-check-input user-checkbox" type="checkbox" checked>
                </td>
                <td class="hidden"><%= user.id %></td>
                <td><%= user.first_name %></td>
                <td><%= user.last_name %></td>
                <td><%= user.email %></td>
              </tr>
            <% end %>
            </tbody>
          </table>
          <button type="button" class="btn btn-primary btn-md" id="approve">Approve</button>
        </div>
      </div>
    <% end %>
    <div class="row" id="users">
      <h2>Users</h2>
      <div class="col">
        <table class="table table-light table-hover">
          <thead>
            <tr>
              <th scope="col">First Name</th>
              <th scope="col">Last Name</th>
              <th scope="col">Email</th>
              <th scope="col">Admin</th>
            </tr>
          </thead>
          <tbody>
            <% @users.all.where(approved: true).each do |user| %>
              <tr>
                <td>
                  <a href="/admin/users/<%= user.id %>">
                    <%= user.first_name %>
                  </a>
                </td>
                <td>
                  <a href="/admin/users/<%= user.id %>">
                    <%= user.last_name %>
                  </a>
                </td>
                <td>
                  <a href="/admin/users/<%= user.id %>">
                    <%= user.email %>
                  </a>
                </td>
                <td>
                  <a class="admin-marker" href="/admin/users/<%= user.id %>/admin">
                    <% if user.admin %>
                      <i class="fas fa-check-circle"></i>
                    <% else %>
                      <i class="fas fa-times-circle"></i>
                    <% end %>
                  </a>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</section>

<%= javascript_pack_tag 'admin_page_functions' %>